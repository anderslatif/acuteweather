<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="icon" type="image/png" href="/acuteweather_logo.png" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>acuteweather</title>
    </head>
    <body>
        <nav>
            <a href="/">
                <img id="acuteweather-logo" src="/acuteweather_logo.png" alt="acuteweather logo">
            </a>

            <svg xmlns="http://www.w3.org/2000/svg" version="1.1" style="display:none">
                <defs>
                    <filter id="squiggly-0">
                        <feTurbulence baseFrequency="0.02" numOctaves="3" result="noise" seed="0" />
                        <feDisplacementMap in="SourceGraphic" in2="noise" scale="2" />
                    </filter>
                    <filter id="squiggly-1">
                        <feTurbulence baseFrequency="0.02" numOctaves="3" result="noise" seed="1" />
                        <feDisplacementMap in="SourceGraphic" in2="noise" scale="3" />
                    </filter>
                    <filter id="squiggly-2">
                        <feTurbulence baseFrequency="0.02" numOctaves="3" result="noise" seed="2" />
                        <feDisplacementMap in="SourceGraphic" in2="noise" scale="2" />
                    </filter>
                    <filter id="squiggly-3">
                        <feTurbulence baseFrequency="0.02" numOctaves="3" result="noise" seed="3" />
                        <feDisplacementMap in="SourceGraphic" in2="noise" scale="3" />
                    </filter>
                    <filter id="squiggly-4">
                        <feTurbulence baseFrequency="0.02" numOctaves="3" result="noise" seed="4" />
                        <feDisplacementMap in="SourceGraphic" in2="noise" scale="2" />
                    </filter>
                </defs>
            </svg>
        </nav>

        <button id="user-gesture-button" style="display: none;">
            Tap to Load Weather
        </button>

        <span id="loader" role="status"></span>

        <div id="acute-weather-info-wrapper" style="display: none;">

            <div id="acuteweather-wrapper">

                <h4>
                    Current temperature (actual <span class="feels-like-emoji">🌡️</span>):
                </h4>

                <div class="temperature-box bordered">
                    <div id="acuteweather-temperature-actual" class="temperature-label">
                        Actual Temperature
                    </div>
                </div>

                <a href="https://open-meteo.com/" id="open-meteo-link">Source</a>

                <h4>
                    Feels like (outdoors <span class="feels-like-emoji">🏞️</span>):
                </h4>

                <div class="temperature-box rainbow-box">
                    <div id="acuteweather-temperature-outdoors" class="temperature-label">
                        Temperature Outdoors
                    </div>
                </div>

                <h3 id="acuteweather-label-sentence"></h3>

                <div id="acuteweather-formula-outdoors" class="formula-box collapsed">
                    <div class="formula-toggle">
                        Double click for the formula 🧮
                    </div>

                    <div class="formula-content">
                        <code class="formula-line">
                            <span class="param-e">e</span> (vapor pressure hPa) = (<span class="param-RH">RH</span> / <span class="param-magic-number">100</span>) × <span class="param-magic-number">6.105</span> × exp((<span class="param-magic-number">17.27</span> × <span class="param-T">T</span>) / (<span class="param-magic-number">237.7</span> + <span class="param-T">T</span>)) = <span id="vapor-pressure-value"></span>hPa
                        </code>
                        <br>

                        <p class="formula-explanation">
                            This calculates the
                            <a class="formula-link" href="https://en.wikipedia.org/wiki/Apparent_temperature#Australian_apparent_temperature" target="_blank">
                                vapor pressure
                            </a>
                            <code class="param-e">e</code> in hPa, using temperature and relative humidity.
                            It represents how much water vapor is present in the air, which influences how effectively the body can cool itself through sweat evaporation.
                        </p>

                        <code id="at-formula" class="formula-line">
                            <span class="param-AT">AT</span> (Apparent Temperature) = <span class="param-T">T</span> + <span class="param-magic-number">0.33</span> × <span class="param-e">e</span> <span class="param-magic-number">−0.70</span> × <span class="param-v">v</span> <span class="param-magic-number">−4.00</span> = <span id="at-value"></span>°C
                        </code>
                        <br>

                        <p class="formula-explanation">
                        	The <code class="param-AT">Apparent Temperature</code> is a baseline measure of perceived temperature.
                        	It combines air temperature, vapor pressure and wind speed:
                        	<code><span class="param-magic-number">0.33</span> × <span class="param-e">e</span></code> adds warmth from humidity,
                        	<code><span class="param-magic-number">−0.70</span> × <span class="param-v">v</span></code> subtracts cooling from wind and
                        	<code><span class="param-magic-number">−4.00</span></code> is a constant calibration offset.
                        </p>

                        <code class="formula-line">
                            <span class="param-R">sunBoost</span> = min(<span class="param-magic-number">3</span>, log(<span class="param-magic-number">1</span> + <span class="param-R">R</span>) × <span class="param-magic-number">0.4</span>) = <span id="sunboost-value"></span>°C
                        </code>

                        <p class="formula-explanation">
                            <span id="sun-boost-value"></span>The <code class="param-R">sunBoost</code> models how sunlight increases warmth perception.
                            The <code>Math.log(<span class="param-magic-number">1</span> + <span class="param-R">R</span>)</code> term adds a diminishing return as radiation increases: it rises quickly at first, then levels off.
                            The multiplier <span class="param-magic-number">0.4</span> scales the impact into °C and the final value is capped at <span class="param-magic-number">3</span> °C to avoid unrealistic warmth under intense sun.
                        </p>

                        <code class="formula-line">
                            <span class="param-P">rainPenalty</span> = min(<span class="param-magic-number">1.5</span>, <span class="param-P">P</span> × <span class="param-magic-number">0.3</span>) = <span id="rainpenalty-value"></span>°C
                        </code>

                        <p class="formula-explanation">
                            <span id="rain-penalty-value"></span>The <code class="param-P">rainPenalty</code> models the cooling sensation caused by rainfall.
                            The product <code><span class="param-P">P</span> × <span class="param-magic-number">0.3</span></code> increases the penalty linearly with precipitation rate, but it is capped at 1.5 °C to reflect saturation. Once you're soaked, more rain doesn’t make it feel significantly colder.
                        </p>

                        <code class="formula-line">
                            <span class="param-dewPenalty">dewPointPenalty</span> = max(<span class="param-magic-number">0</span>, <span class="param-D">D</span> − <span class="param-magic-number">16</span>) × <span class="param-magic-number">0.2</span> = <span id="dewpenalty-value"></span>°C
                        </code>

                        <p class="formula-explanation">
                            <span id="dew-penalty-value" class="param-dewPenalty"></span>The <code class="param-dewPenalty">dewPointPenalty</code> relates to the body's ability to sweat. It can never have a positive effect (max of <span class="param-magic-number">0</span>) and always subtracts from the felt temperature. See more on
                            <a href="https://en.wikipedia.org/wiki/Dew_point#Relationship_to_human_comfort" class="formula-link" target="_blank">dew point and human comfort</a>. It kicks in only above <span class="param-magic-number">16</span> °C.
                        </p>

                        <code class="formula-line">
                            <span class="param-humidityDiscomfort">humidityDiscomfort</span> = abs(<span class="param-RH">RH</span> − <span class="param-magic-number">45</span>) × <span class="param-magic-number">0.05</span> = <span id="humiditydiscomfort-value"></span>°C
                        </code>

                        <p class="formula-explanation">
                            <span id="humidity-discomfort-value" class="param-humidityDiscomfort"></span><code class="param-humidityDiscomfort">humidityDiscomfort</code> is triggered any time relative humidity is not <span class="param-magic-number">45</span>% (<a href="https://en.wikipedia.org/wiki/Humidity#Human_comfort" class="formula-link" target="_blank">Source</a>). If it’s too low, the temperature will feel cooler and drier due to increased evaporation. If it’s too high, it will feel warmer and muggier because sweat can’t evaporate efficiently.
                        </p>

                        <code class="formula-line">
                            <span class="param-windChill">windChill</span> = <span class="param-magic-number">13.12</span> + <span class="param-magic-number">0.6215</span> × <span class="param-T">T</span> <code><span class="param-magic-number">−11.37</span> × <span class="param-v">v</span><sup><span class="param-magic-number">0.16</span></sup></code> <code>+ <span class="param-magic-number">0.3965</span> × <span class="param-T">T</span> × <span class="param-v">v</span><sup><span class="param-magic-number">0.16</span></sup></code> = <span id="windchill-value"></span>°C
                        </code>

                        <p class="formula-explanation">
                            Will be shown as '-' if not applicable. <br>
                            The <a href="https://en.wikipedia.org/wiki/Wind_chill#North_American_and_UK_method" class="formula-link" target="_blank">wind chill formula</a> is the official metric model adopted by multiple national weather agencies following the 2001 update.<br><br>
                            The constant <code class="param-magic-number">13.12</code> is a baseline starting point.
                            The term <code><span class="param-magic-number">0.6215</span> × <span class="param-T">T</span></code> represents direct warming from the actual air temperature.
                            The subtraction term <code><span class="param-magic-number">−11.37</span> × <span class="param-v">v</span><sup><span class="param-magic-number">0.16</span></sup></code> models cooling from wind speed alone.<br>
                            The final term <code>+ <span class="param-magic-number">0.3965</span> × <span class="param-T">T</span> × <span class="param-v">v</span><sup><span class="param-magic-number">0.16</span></sup></code> adjusts that cooling effect based on how temperature interacts with wind speed.
                            <br><br>
                            The result estimates how much colder it feels on exposed skin compared to the actual temperature.
                        </p>

                        <code class="formula-line">
                            FeelsLikeOutdoors = <span class="param-T">T</span> + <span class="param-magic-number">0.33</span> × <span class="param-e">e</span> − <span class="param-magic-number">0.70</span> × <span class="param-v">v</span> − <span class="param-magic-number">4.00</span> + <span class="param-R">sunBoost</span> − <span class="param-P">rainPenalty</span> − <span class="param-dewPenalty">dewPenalty</span> − <span class="param-humidityDiscomfort">humidityDiscomfort</span> = <span id="outdoor-feelslike-value"></span>°C
                        </code>

                        <p class="formula-explanation">
                            This formula starts with Apparent Temperature and adds a boost from solar radiation, subtracts cooling from rain and accounts for dew point and humidity discomfort.
                        </p>

                        <p class="params-explanation">
                            The values are the actual current weather values.
                        </p>
                        <ul id="outdoor-params"></ul>
                    </div>
                </div>

                <h4>
                    Feels like (indoors <span class="feels-like-emoji">🏠</span>):
                </h4>

                <div class="temperature-box grayscale">
                    <div id="acuteweather-temperature-indoors" class="temperature-label">
                        Temperature Indoors
                    </div>
                </div>

                <div id="acuteweather-formula-indoors" class="formula-box collapsed">
                    <div class="formula-toggle">
                        Double click for the formula 🧮
                    </div>

                    <div class="formula-content">
                        <code class="formula-line">
                            <span class="param-e">e</span> (vapor pressure hPa) = (<span class="param-RH">RH</span> / <span class="param-magic-number">100</span>) × <span class="param-magic-number">6.105</span> × exp((<span class="param-magic-number">17.27</span> × <span class="param-T">T</span>) / (<span class="param-magic-number">237.7</span> + <span class="param-T">T</span>)) = <span id="indoor-vapor-pressure-value"></span> hPa
                        </code>
                        <br>

                        <p class="formula-explanation">
                            Vapor pressure <code class="param-e">e</code> is calculated from temperature and relative humidity and reflects how much moisture is in the air.
                        </p>

                        <code class="formula-line">
                            <span class="param-dewPenalty">dewPointPenalty</span> = max(<span class="param-magic-number">0</span>, <span class="param-D">D</span> − <span class="param-magic-number">16</span>) × <span class="param-magic-number">0.2</span> = <span id="indoor-dewpenalty-value"></span>°C
                        </code>

                        <p class="formula-explanation">
                            <span id="dew-penalty-value" class="param-dewPenalty"></span>The <code class="param-dewPenalty">dewPointPenalty</code> relates to the body's ability to sweat. It can never have a positive effect (max of <span class="param-magic-number">0</span>) and always subtracts from the felt temperature. See more on
                            <a href="https://en.wikipedia.org/wiki/Dew_point#Relationship_to_human_comfort" class="formula-link" target="_blank">dew point and human comfort</a>. It kicks in only above <span class="param-magic-number">16</span> °C.
                        </p>

                        <code class="formula-line">
                            <span class="param-humidityDiscomfort">humidityDiscomfort</span> = abs(<span class="param-RH">RH</span> − <span class="param-magic-number">45</span>) × <span class="param-magic-number">0.05</span> = <span id="indoor-humiditydiscomfort-value"></span>°C
                        </code>

                        <p class="formula-explanation">
                            <span id="humidity-discomfort-value" class="param-humidityDiscomfort"></span><code class="param-humidityDiscomfort">humidityDiscomfort</code> is triggered any time relative humidity is not <span class="param-magic-number">45</span>% (<a href="https://en.wikipedia.org/wiki/Humidity#Human_comfort" class="formula-link" target="_blank">Source</a>). If it’s too low, the temperature will feel cooler and drier due to increased evaporation. If it’s too high, it will feel warmer and muggier because sweat can’t evaporate efficiently.
                        </p>

                        <code class="formula-line">
                            <span class="param-R">sunBoost</span> = isDay ? min(<span class="param-magic-number">1.5</span>, log(<span class="param-magic-number">1</span> + <span class="param-R">R</span>) × <span class="param-magic-number">0.1</span>) : <span class="param-magic-number">0</span> = <span id="indoor-sunboost-value"></span>°C
                        </code>

                        <p class="formula-explanation">
                            This <code>sunBoost</code> models indirect indoor sunlight exposure. When it's daytime (<code>isDay</code> is true), solar radiation is scaled to 10% of its outdoor effect using <code>log(1 + R) × 0.1</code>. The result is capped at 1.5 °C. At night, the value is 0.
                        </p>

                        <code class="formula-line">
                            FeelsLikeIndoors = <span class="param-T">T</span> + <span class="param-magic-number">0.33</span> × <span class="param-e">e</span> − <span class="param-magic-number">0.1</span> × <span class="param-v">v</span> + sunBoost − <span class="param-dewPenalty">dewPenalty</span> − <span class="param-humidityDiscomfort">humidityDiscomfort</span> = <span id="indoor-feelslike-value"></span>°C
                        </code>
                        <br>

                        <p class="formula-explanation">
                            Indoors, environmental effects are reduced.
                            Wind is scaled down to 10% with <span class="param-magic-number">0.1</span> × <span class="param-v">v</span>, modeling limited indoor airflow like drafts or ventilation.
                            Sunlight is scaled by <span class="param-magic-number">0.1</span> × <span class="param-R">R</span>, simulating indirect exposure through windows.
                            This captures how insulation and barriers buffer indoor conditions from outdoor extremes.
                        </p>

                        <p class="params-explanation">
                            The values are the actual current weather values.
                        </p>
                        <ul id="indoor-params"></ul>
                    </div>
                </div>

            </div>

            <div id="acuteweather-axes-wrapper">
                <div class="axis" data-axis="thermal">
                    <label class="axis-label">Feels like (outdoors)</label>
                    <div class="emoji-row">
                        <div>🥶</div>
                        <div>🧊</div>
                        <div>🆒</div>
                        <div>🙂</div>
                        <div>🌤️</div>
                        <div>🔥</div>
                        <div>🌋</div>
                    </div>
                    <div class="bar">
                        <div class="fill" id="thermal-fill"></div>
                    </div>
                    <div class="labels">
                        <div>freezing</div>
                        <div>cold</div>
                        <div>cool</div>
                        <div>comfortable</div>
                        <div>warm</div>
                        <div>hot</div>
                        <div>sweltering</div>
                    </div>
                </div>

                <div class="axis" data-axis="humidity">
                    <label class="axis-label">Humidity (dew point)</label>
                    <div class="emoji-row">
                        <div>🏜️</div>
                        <div>🍂</div>
                        <div>😌</div>
                        <div>💧</div>
                        <div>😶‍🌫️</div>
                        <div>💦</div>
                    </div>
                    <div class="bar">
                        <div class="fill" id="humidity-fill"></div>
                    </div>
                    <div class="labels">
                        <div>dry</div>
                        <div>crisp</div>
                        <div>mild</div>
                        <div>humid</div>
                        <div>muggy</div>
                        <div>oppressive</div>
                    </div>
                </div>

                <div class="axis" data-axis="sun">
                    <label class="axis-label">Solar Radiation (cloudiness)</label>
                    <div class="emoji-row">
                        <div>☁️</div>
                        <div>🌥️</div>
                        <div>🌤️</div>
                        <div>☀️</div>
                    </div>
                    <div class="bar">
                        <div class="fill" id="sun-fill"></div>
                    </div>
                    <div class="labels">
                        <div>overcast</div>
                        <div>dim</div>
                        <div>bright</div>
                        <div>blazing</div>
                    </div>
                </div>
            </div>
        </div>

        <script type="module" src="/src/main.js"></script>
    </body>
</html>
